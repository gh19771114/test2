# SMTP 认证问题排查指南

## 当前错误：EAUTH - 认证失败

错误代码 `EAUTH` 表示 SMTP 服务器拒绝了您的用户名或密码。

## 可能的原因和解决方案

### 1. 用户名或密码错误

**检查清单：**
- ✅ 确认 `SMTP_USER` 中的邮箱地址是否正确
- ✅ 确认 `SMTP_PASS` 中的密码是否正确
- ✅ 确认密码中没有多余的空格或特殊字符

**当前配置：**
```
SMTP_USER=info@bournmark.jp
SMTP_PASS=Mark@7745
```

### 2. 用户名格式问题

某些邮件服务器可能需要不同的用户名格式：

**尝试方案 A：使用完整邮箱地址（当前）**
```env
SMTP_USER=info@bournmark.jp
```

**尝试方案 B：只使用用户名部分**
```env
SMTP_USER=info
```

**尝试方案 C：使用域名前缀**
```env
SMTP_USER=bournmark.jp\info
```

### 3. 密码中的特殊字符

如果密码包含特殊字符（如 `@`、`#`、`$` 等），可能需要：
- 使用引号包裹密码
- 或者使用 URL 编码

**示例：**
```env
SMTP_PASS="Mark@7745"
```

### 4. 需要应用专用密码

某些邮件服务（如 Gmail、企业邮箱）需要使用应用专用密码而不是普通密码。

**检查：**
- 是否需要在邮箱设置中生成应用专用密码？
- 是否需要在邮箱管理面板中开启 SMTP 服务？

### 5. 认证方法问题

代码中已设置使用 `PLAIN` 认证方法。如果仍然失败，可以尝试：

**修改认证方法：**
编辑 `pages/api/send-form.ts`，在 `auth` 配置中尝试：
- `method: 'LOGIN'` - 某些服务器需要 LOGIN 方法
- `method: 'PLAIN'` - 标准 PLAIN 方法（当前使用）

### 6. 联系邮件服务提供商

由于您使用的是 Ricoh 邮件托管服务（`mail.hosting.ricoh.co.jp`），建议：

1. **联系 Ricoh 邮件服务支持**，确认：
   - 正确的 SMTP 服务器地址
   - 正确的端口号（465 或 587）
   - 正确的用户名格式
   - 是否需要特殊的认证方式
   - 是否需要 IP 白名单

2. **检查邮箱管理面板**：
   - 确认 SMTP 服务已启用
   - 确认账户没有被锁定
   - 查看是否有安全设置阻止了外部连接

### 7. 测试步骤

1. **验证用户名和密码**：
   - 尝试使用邮件客户端（如 Outlook、Thunderbird）使用相同的凭据连接
   - 如果邮件客户端可以连接，说明凭据正确，问题可能在代码配置
   - 如果邮件客户端也无法连接，说明凭据或服务器配置有问题

2. **检查服务器日志**：
   - 查看开发服务器的控制台输出
   - 查看是否有更详细的错误信息

3. **尝试不同的端口**：
   ```env
   # 尝试端口 465
   SMTP_PORT=465
   SMTP_SECURE=true
   
   # 或尝试端口 587
   SMTP_PORT=587
   SMTP_SECURE=false
   ```

## 临时解决方案

如果急需测试，可以考虑：

1. **使用其他邮件服务**（如 Gmail）进行测试
2. **使用邮件服务 API**（如 SendGrid、Mailgun）代替 SMTP

## 需要帮助？

如果以上方法都无法解决问题，请提供：
1. 完整的错误信息（包括服务器响应）
2. 邮件服务提供商的文档或支持联系方式
3. 是否可以使用邮件客户端成功连接



